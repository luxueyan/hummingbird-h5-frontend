webpackJsonp([4],{"+JCH":function(n,e){n.exports={render:function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("section",{staticClass:"fb-bank-cards"},[n._m(0),a("div",{staticClass:"fields"},[a("div",{staticClass:"cells"},[a("mt-cell",{staticClass:"pt10",attrs:{"is-link":"is-link"},nativeOn:{click:function(e){n.$router.push({name:"bankList"})}}},[a("div",{staticClass:"content",slot:"title"},[a("div",{staticClass:"content-icon"},[a("fb-icon",{attrs:{name:n.getBankIcon(n.defaultBankCard.bankName)}})],1),a("div",{staticClass:"content-body"},[a("div",{staticClass:"title"},[a("h3",[n._v(n._s(n.defaultBankCard.bankName))])]),a("p",[n._v(n._s(n._f("fbBankCardSpace")(n.defaultBankCard.bankCard)))])])])])],1),a("router-link",{staticClass:"add-bankcard",attrs:{to:{name:"addBankStep1"}}},[a("em",[n._v("+")]),n._v("添加银行卡")])],1)])},staticRenderFns:[function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("div",{staticClass:"fields-header"},[a("i",{staticClass:"iconfont icon-bank-card3"}),n._v("银行账户")])}]}},"/p9w":function(n,e,a){a("XmrS");var t=a("VU/8")(a("pFqE"),a("+JCH"),null,null);n.exports=t.exports},"1bAC":function(n,e,a){e=n.exports=a("FZ+f")(),e.push([n.i,".fb-bank-cards .add-bankcard{font-size:15px;padding:15px 10px;text-align:center;background:#fff;color:inherit;display:block;background-image:linear-gradient(0deg,#d9d9d9,#d9d9d9 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:top}.fb-bank-cards .add-bankcard.no-border{background-image:none}.fb-bank-cards .add-bankcard:active{background:#f2f2f2}.fb-bank-cards .add-bankcard em{font-size:1.2em;margin-right:.2em}.fb-bank-cards .mint-cell:active{background-color:#f2f2f2}.fb-bank-cards .mint-cell-mask{display:none}.fb-bank-cards .mint-radiolist-label{padding:0 0 12px 2px;font-size:14px;margin-top:-5px;float:left;color:#4790fe}.fb-bank-cards .mint-radio-input:checked+.mint-radio-core{background-color:#4790fe;border-color:#4790fe}.fb-bank-cards .mint-radio-label{color:#4790fe}.fb-bank-cards .mint-radio-core{border-color:#4790fe}.fb-bank-cards .title{display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.fb-bank-cards .content-icon{padding-right:19px}.fb-bank-cards .content-icon .icon-svg{width:39px;height:39px}.fb-bank-cards .content{display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center;line-height:1.8em;font-size:14px;overflow:hidden;padding:10px 0}.fb-bank-cards .content h3{-webkit-flex:1;-ms-flex:1;flex:1;font-size:15px;font-weight:400}.fb-bank-cards .content p{overflow:hidden;text-overflow:ellipsis;color:#666}",""])},"4JGu":function(n,e,a){"use strict";a.d(e,"a",function(){return m});var t=a("Dd8w"),r=a.n(t),o=a("Xxa5"),i=a.n(o),s=a("exGp"),c=a.n(s),d=a("oiih"),u=a("NYxO"),l=a("3dbI"),f=a("M4fF"),b=(a.n(f),[{name:"农业",icon:"nongye"},{name:"中国银行",icon:"zhongguo"},{name:"兴业",icon:"nongye"},{name:"工商",icon:"gongshang"},{name:"建设",icon:"jianshen"},{name:"交通",icon:"jiaotong"},{name:"北京",icon:"beijing"},{name:"民生银行",icon:"minsheng"},{name:"光大",icon:"guangda"},{name:"上海",icon:"shanghai"},{name:"中信",icon:"zhongxin"},{name:"浙商",icon:"zheshang"},{name:"邮政",icon:"youzhengchuxu"},{name:"华夏",icon:"huaxia"},{name:"渤海",icon:"bohai"},{name:"平安",icon:"pingan"},{name:"恒丰",icon:"hengfeng"},{name:"浦发",icon:"pufa"},{name:"招商",icon:"zhaoshang"},{name:"广发",icon:"guangfa"}]),m={methods:{getBankIcon:function(n){var e=a.i(f.find)(b,function(e){return~n.indexOf(e.name)});return(e?e.icon:"")+"yinhang"},showSupportBanks:function(){var n=this;return c()(i.a.mark(function e(){var a,t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.$store.getters.supportBankCards,!a.length){e.next=5;break}n.$msgBox("支持银行列表：",a.join("、")),e.next=10;break;case 5:return e.next=7,l.e.get().then(function(n){return n.json()});case 7:t=e.sent,n.$store.commit("updateSupportBankCards",t.data),n.$msgBox("支持银行列表：",t.data.join("、"));case 10:case"end":return e.stop()}},e,n)}))()}}};e.b={methods:r()({},a.i(u.a)(["getMsgCode"]),m.methods,{getBank:function(){var n=this;return c()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.validation.isPassed("model.bankCard")&&setTimeout(c()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.f.get({cardNo:n.model.bankCard}).then(function(n){return n.json()});case 2:a=e.sent,a.code===d.a.OK?(n.model.bankName=a.data.bankName,n.model.bankCode=a.data.bankCode):(n.model.bankName="自动生成",n.model.bankCode=""),n.bankCardNotSupported=a.code===d.a.BANK_CARD_NOT_SUPPORTED,n.$validate("model.bankCard");case 6:case"end":return e.stop()}},e,n)})),100);case 1:case"end":return e.stop()}},e,n)}))()},toGetMsgCode:function(){var n=this;return c()(i.a.mark(function e(){var t,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.$validate(n.validatePhoneModel);case 2:if(!(t=e.sent)){e.next=10;break}return e.next=6,n.getMsgCode({phone:a.i(f.get)(n,n.validatePhoneModel),label:n.$route.meta.captchaSendType||""});case 6:r=e.sent,r.code===d.a.OK&&(n.countdownVisible=!0,n.$refs.fnCountdown.start()),e.next=11;break;case 10:n.$toast(n.validation.firstError(n.validatePhoneModel),"error");case 11:case"end":return e.stop()}},e,n)}))()},onCountdownOver:function(){this.countdownVisible=!1}}),watch:{bankCardForShow:function(){this.model.bankCard=this.bankCardForShow=this.bankCardForShow.replace(/\s/g,""),this.bankCardForShow=this.bankCardForShow.replace(/\d{4}(?=(\d{1,4}))/g,"$& ")},"model.bankCard":function(){this.bankCardNotSupported=!1}},data:function(){return{bankCardForShow:"",bankCardNotSupported:!1,validatePhoneModel:"user.phone",countdownVisible:!1}}}},"4VtY":function(n,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=a("mvHQ"),r=a.n(t),o=a("Dd8w"),i=a.n(o),s=a("Xxa5"),c=a.n(s),d=a("woOf"),u=a.n(d),l=a("exGp"),f=a.n(l),b=a("3dbI"),m=a("z0iR"),p=a("NYxO"),k=a("/p9w"),h=a.n(k),g=a("oiih"),v=a("IcnI"),C=a("PJh5"),x=a.n(C);e.default={mixins:[m.a],components:{FbBankCards:h.a},beforeRouteEnter:function(n,e,a){var t=this;return f()(c.a.mark(function n(){var e,r;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=v.a.getters.user,n.next=3,b.a.get({id:e.currentOngoingContract.id}).then(function(n){return n.json()});case 3:r=n.sent,a(function(n){r.code===g.a.OK&&(n.model=u()({},r.data))});case 5:case"end":return n.stop()}},n,t)}))()},methods:{goChangeBankCard:function(){this.$router.push({name:"bankList"})},repayConfirm:function(){var n=this;new Date-x()(this.model.startDateTs).toDate()<=864e5?this.$msgBox.confirm("确认提交还款?").then(function(e){"confirm"===e&&n.repay()}).catch(function(){}):this.repay()}},computed:i()({},a.i(p.b)(["stateCode"])),data:function(){var n=JSON.parse(r()(this.$store.getters.user));return{model:{name:n.name,idCard:null,bankCard:null,bank:"",bankPhone:null},user:n}}}},Ce9l:function(n,e){n.exports={render:function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("div",{staticClass:"repay-info"},[a("div",{staticClass:"form"},[a("section",[a("div",{staticClass:"fields-header"},[a("i",{staticClass:"iconfont icon-fangan"}),n._v("还款计划"),a("small",{staticClass:"fr loan-agreement"},[n._v("查看"),a("router-link",{attrs:{to:{name:"loanAgreement"}}},[n._v("《借款服务协议》")])],1)]),a("div",{staticClass:"fields"},[a("mt-cell",{attrs:{title:"借款金额",value:n._f("fbCurrency")(n.model.contractAmount)}}),a("mt-cell",{attrs:{title:"应还日期",value:n._f("fbFalse")(n.model.contractEndDate)}}),a("mt-cell",{attrs:{title:"应还金额",value:n._f("fbCurrency")(n.model.contractAmount)}})],1)]),a("fb-bank-cards"),a("div",{staticClass:"form-buttons"},[a("mt-button",{staticClass:"mint-button-block",attrs:{type:"primary",size:"large"},on:{click:function(e){n.repayConfirm()}}},[n._v("立即还款")])],1)],1)])},staticRenderFns:[]}},XmrS:function(n,e,a){var t=a("1bAC");"string"==typeof t&&(t=[[n.i,t,""]]),t.locals&&(n.exports=t.locals);a("rjj0")("a0f299a8",t,!0)},"k+kw":function(n,e,a){var t=a("VU/8")(a("4VtY"),a("Ce9l"),null,null);n.exports=t.exports},pFqE:function(n,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=a("Xxa5"),r=a.n(t),o=a("exGp"),i=a.n(o),s=a("3dbI"),c=a("4JGu"),d=a("oiih"),u=a("M4fF");a.n(u);e.default={mixins:[c.a],mounted:function(){var n=this;return i()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.d.get().then(function(n){return n.json()});case 2:t=e.sent,t.code===d.a.OK&&(n.defaultBankCard=a.i(u.find)(t.data.bankCards,function(n){return n.isDefault}),n.$store.commit("updateBankCardsCount",t.data.bankCards.length));case 4:case"end":return e.stop()}},e,n)}))()},data:function(){return{defaultBankCard:{bankName:"",bankCard:""}}}}},z0iR:function(n,e,a){"use strict";var t=a("Xxa5"),r=a.n(t),o=a("exGp"),i=a.n(o),s=a("Dd8w"),c=a.n(s),d=a("3dbI"),u=a("oiih"),l=a("NYxO");e.a={methods:c()({},a.i(l.c)(["updateStateCode"]),{repay:function(){var n=this;return i()(r.a.mark(function e(){var a,t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.c.save({contractId:n.$store.getters.user.currentOngoingContract.id}).then(function(n){return n.json()});case 2:a=e.sent,a.code===u.a.OK&&(t=a.data.repaymentStatus,0===t?(n.updateStateCode(u.b.REPAYING),n.$router.push({name:"repaying"})):2===t?n.$toast("支付系统升级中！","error"):n.$toast("抱歉，系统繁忙","error"));case 4:case"end":return e.stop()}},e,n)}))()}})}}});